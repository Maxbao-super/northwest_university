> [计算机网络-概述]()
>
> [计算机网络-物理层]()
>
> [计算机网络-数据链路层]()
>
> [计算机网络-网络层]()
>
> [计算机网络-传输层]()
>
> [计算机网络-应用层]()


# 物理层(Physical Layer)

![物理层导图](img\物理层导图.jpeg)

## 通信基础

### 概念

**解决如何在连接各种计算机的传输媒体上传输媒体上传输数据比特流**

**主要任务**：确定与传输媒体接口有关的一些特性-->定义标准

**接口特性**:

1. 机械特性：定义物理连接的特性，规定物理连接时所采用的规格、接口形状、**引线数目**、**引脚数量**和排列情况
2. 电气特性：规定传输二进制位时，线路上信号的**电压范围**、阻抗匹配、传输**速率**和**距离**限制等
3. 功能特性：指明某条线上出现的某一**电平表示何种意义**，接口部件的信号线的用途
4. 规程(过程特性)：定义各条物理线路的工作**规程和时序**关系

### 数据通信

**在不同计算机之间传输表示信息的二进制数的过程**

数据通信模型：

![数据通信模型](img\典型的数据通信模型.png)

通信目的：传送**消息**（语音、文字、图像、视频等）

**数据data**：传送消息的实体，有意义的符号序列

**信号**：数据的电器/电磁的表现，数据在传输过程中的存在形式

数字信号/离散信号：消息的参数取值是离散的

模拟信号/连续信号：消息参数的取值是连续的

**信源**：产生和发生数据的源头

**信宿**：接收数据的终点

**信道**：信号的传输媒介，有方向性

**通信方式**：

* 单工通信：只有一个方向的通信，仅需要一条信道
* 半双工/双向交替：双方都可以发送或接受消息，但是不能同时发送和接受，需要两条信道
* 全双工/双向同时：双方都可以发送和接收消息，需要两条信道

**传输方式**：

* 串行传输：表示一个字符的8为二进制数按由低到高的顺序依次发送
  * 速度慢，费用低，适合远距离
* 并行传输：表示一个字符的8位二进制数同时通过8条信道发送
  * 速度快，费用高，适合近距离
* 同步传输：数据传送以一个数据区块为单位，也叫**区块传输**
  * 传输时先传输一个或多个同步字符，再送出整批数据
* 异步传输：将比特分成小组传送，小组可以是多位字符，发送端随时发送，但接受端不知道何时到达
  * 传输需要加字符起始位和字符终止位

**码元**：用一个**固定时长**的**信号波形**(数字脉冲)，代表不同离散数值的基本波形，是数字通信中数字信号的计量单位。时长成为**码元宽度**。当码元的离散状态为M时，成为M(M>2)进制码元。

**n(n>1)码元可以携带$\log_2n$个比特的信息量**

**速率**:也叫数据率,是数据的传输速率,表示单位时间内传输的数据量

* 码元传输速率：单位时间内数字通信系统所传输的码元个数(脉冲个数或信号变化次数),**单位波特(Baud)**
  * 码元速率、波形速率、调制速率、符号速率
  * 码元速率只与码元长度T有关$R_B=\frac{1}{T}(B)$
* 信息传输速率：单位时间内数字通信系统传输的二进制码元数(比特数)，单位比特/秒(b/s)
  * 信息速率、比特率
* 一个码元携带nbit信息量，M Baud码元传输速率对应$M*n$bit/s

**带宽**

* 模拟信号系统：输入的信号频率高或低到一定程度，使系统的输出功率成为输入功率的一半时(-3dB)，最高频率和最低频率间的差值，单位赫兹(Hz)
* 数字设备：单位时间内从网络中的某点到另一点所能通过的“最高传输数据率”或单位时间内通过链路的数量，表示网络的通信线路所能传输数据的能力，单位比特/秒(bps)

### 奈氏准则

**失真**：收到干扰，收到的信号失去真实性

**影响失真程度的因素**：

1. 码元传输速率
2. 信号传输距离
3. 噪声干扰
4. 传输媒体质量

**码间串扰**：接收端收到的信号波形失去了码元之间清晰界限的现象

**信道带宽**：信道能通过的最高频率和最低频率之差

**奈奎斯特定理**：在理想低通(无噪声,带宽受限)条件下，为避免码间串扰，极限码元传输速率为$2W$Baud，W是信道带宽，单位Hz。**限制码元的传输速率**

> 奈氏准则的极限数据率：$2Wlog_2V$(b/s)
>
> W：带宽；V：几种码元或码元的离散电平数目

**奈氏准则结论**：

1. 任何信道中，码元传输速率是有上限的
2. 信道的频带越宽(能通过的信号高频分量越多)，就可以用更高的速率进行码元的有效传输
3. **只限制码元传输速率，但并没有限制信息传输速率**
4. 要提高数据的传输速率，就要使每个码元能携带更多的比特信息量，即采用多元制的调制方法

### 香农定理

**噪声**：存在于所有电子设备和通信信道，可随时产生

**信噪比**：信号强，则噪声的影响就小；反之则影响较大

* 信号的平均功率/噪声的平均功率,记为S/N,单位dB

* $信噪比(dB)=10log_{10}(S/N)$

**香农定理**：在带宽受限且有噪声的信道中，为了不产生误差，信息的数据传输速率设有上限值。信道的极限数据传输速率=$Wlog_2(1+S/N)$(b/s)。W：带宽；S/N：信噪比

**推论**：

1. 信道的带宽或信道中的信噪比越大，信息的极限传输速率越高
2. 对确定的带宽和信噪比，则信道的最大传输速率就确定了
3. 只要信息的传输速率低于极限传输速率，就能通过某种方法实现**无差错的传输**
4. 实际信道所能达到的传输速率要低于香农定理所得出的极限速率
5. 若信道带宽W或信噪比S/N没有上限，则极限传输速率也就没有上限

> 奈氏准则：为了避免码间串扰，
>
> 香农定理：在带宽受限且有噪声的信道中的信息传输速率

### 编码与调制

**基带信号**：将数字信号1和0直接用两种不同电压表示，再送到**数据信道**上传输

* 直接表达了要传输的信息的信号，**来自信源的信号**

**宽带信号**：将基带信号进行调制后形成的频分复用模拟信号，再传送到模拟信道上传输

* 把基带信号进行载波调制，把信号的频率范围搬移到较高的频段以便在信道中传输

**编码**：数据转换成数字信号，数字数据通过数字发送器，模拟数据通过PCM编码器

**调制**：数据转换成模拟信号，数字数据通过调制器，模拟数据通过放大器调制器

#### 数字数据编码为数字信号

1. 非归0编码NRZ
   * 高1低0，编码容易实现，没有检错功能且无法判断一个码元的开始和结束，收发双方难以保持同步
2. 曼彻斯特编码
   * 将码元分为两个相等的间隔，**前高后低**就是1，**前低后高**就是0
   * 在每个码元间都出现电平跳变，位中间的跳变既可以作为时钟信号，也可以作为数据信号
   * 所占频带宽度是原始基带宽度的两倍
   * 数据传输速率只有调制速率的$\frac12$,一秒传输的脉冲次数(曼彻斯特一个码元脉冲变换了两次)

3. 差分曼彻斯特编码
   * 码元为1，则前半个码元与上一个码元的后半个码元相同，反之亦然。
   * 每个码元中间都有一次电平转换，可以实现自同步
   * 抗干扰性强于曼彻斯特编码

4. 归零编码RZ：信号电平在一个码元内都要归为0
5. 反向不归零编码NRZI：信号电平翻转表示0，信号电平不翻转表示1
6. 4B/5B编码：比特流中插入额外比特以打破一连串的0或1，用5个比特编码4个比特，再传给接收方，编码效率为40%（16种对应不同的4位码，剩余16种作为控制码，表示帧的开始和结束、线路状态信息等）或保留

#### 数字数据调制为模拟信号

**发送端将数字信号转换为模拟信号(调制)，在接收端把模拟信号还原成数字信号(解调)**

调制：

* ASK调幅：0没有振幅，1有振幅
* FSK调频：0低频，1高频
* PSK调相：对相位的调制，0和1分别对应正弦波和余弦波
* QAM调幅+调相(正交振幅调制)

#### 模拟数据编码为数字信号

PCM脉码调制可以做到对音频信号达到最高保真水平

1. 抽样：对模拟信号周期性扫描，把时间上连续的信号变成时间上离散的信号
   * 采样定理：$f_{采样频率}\ge2f_{信号最高频率}$
2. 量化：抽样取得的电平幅值按照一定分级标准转化为对应的数字值，并取整数，把连续的电平幅值转换为离散的数字量
3. 编码：把量化的结果转换为与之对应的二进制编码

#### 模拟数据调制为模拟信号

### 数据交换

#### 电路交换

**在数据传输期间，源结点与目的结点之间有一条由中间节点构成的专用物理连接线路，数据传输结束之前，这条线路将会一直保持**

电路交换阶段：

* 建立连接：呼叫或建立连接
* 通信：数据传输
* 释放连接：拆除电路

特点：**独占资源**，用户始终占用端到端的固定传输带宽。适用于**远程批处理信息传输或系统间实时性要求高的大量数据传输**

|               优点               |                             缺点                             |
| :------------------------------: | :----------------------------------------------------------: |
|            传输时延小            |                        建立连接时间长                        |
|     数据顺序传送，无失序问题     |                   线路独占，信道使用效率低                   |
| 实时性强，适用于交互式会话类通信 | 灵活性差，连接时出现故障必须重新拨号建立连接，不适用于突发性通信 |
|   全双工通信，不会征用物理信道   |                        无数据存储能力                        |
|     适用于数字信号和模拟信号     |        不同类型、不同规格、不同速率的终端很难相互通信        |
| 控制简单，电路交换设备及控制简单 |           无法发现与纠正传输差错，难以进行差错控制           |

#### 报文交换

**报文**：网络中交换与传输的数据单元，站点一次性要发送的数据块。包含了将要发送的完整数据信息，长度不一致，长度不限且可变。<span style="color:red">报文=数据块+报头(源地址和目的地址)</span>

**无需在两个站点之间建立一条专用通道，其数据传输的单位是报文，传送过程采用<span style="color:red">存储转发</span>方式**



> 对报文进行缓存，当电路空闲时，根据路由信息找到下一个结点地址并传送

|                             优点                             |                          缺点                          |
| :----------------------------------------------------------: | :----------------------------------------------------: |
|        无需建立连接，没有连接时延，用户可随时发送报文        | 实时性差，不适合传送实时或交互式业务数据，存在转发时延 |
|                动态分配心啊路，可以平滑通信量                |                    只适用于数字信号                    |
|                        提高线路可靠性                        |              要求每个结点要有较大的缓冲区              |
|                        提高线路利用率                        |         若把报文存在磁盘上则进一步增加传送时延         |
|         提供多目标服务，一个报文可发送至多个目的地址         |                                                        |
| 存储转发中容易实现代码转换和速率匹配，便于类型、规格、速度不同的计算机之间通信 |                                                        |

#### 分组交换

**分组**：将数据分割成小块，逐块发送，每个块就是一个分组。<span style="color:red">分组=数据块+控制信息(源地址+目的地址+编号)</span>

**采用<span style="color:red">存储转发</span>，分组交换网中限制所传输的数据单位长度，一般为128B。**发送端将数据分成一定长度的分组，以分组为单位进行传输，接收端收到分组进行组装成信息或报文。

|                        优点                        |                           缺点                           |
| :------------------------------------------------: | :------------------------------------------------------: |
|           无连接时延，用户可随时发送分组           |     存在传送时延，并且要求结点交换机有更强的处理能力     |
|           线路利用率高，多分组可共享信道           | 每个分组都要增加控制信息，降低了通信效率，增加了处理时间 |
|                    简化存储管理                    |      分组传出数据可能出现失序、丢失或重复分组的现象      |
|             加速传输，减少等待发送时间             |                                                          |
| 减少出错几率和重发数据量，提高可靠性，减少传输时延 |                                                          |
|           分组短小，适用于突发式数据通信           |                                                          |

> 交换方式的对比与选择
>
> 1. 传送数据量大，且传送时间远大于呼叫时，选择**电路交换**。电路交换的传输时延最小。
> 2. 端到端的通路有很多段的链路组成时，采用**分组交换**传送数据较为合适。
> 3. 信道利用率：**报文交换**和**分组交换**优于**电路交换**，并且**分组交换**的时延小于**报文交换**

#### 数据报方式

![数据包传输过程](img\数据报交换过程.png)

1. 主机A将**报文分成多个分组**，依次发送到结点A
2. 结点A收到分组后，对每个分组进行**差错检测**和**路由选择**，分发到下一个结点
3. 结点C收到分组$P_1$，对分组$P_1$进行**差错检测**，若正确则向A发送**确认信息**，A收到**确认信息**后则丢弃分组$P_1$的副本
4. 最终主机B收到是所有分组

特点：

1. **数据报**为网络层提供无连接服务。发送方可随时发送分组，网络中的结点可随时接收分组

> <span style="color:red">无连接服务</span>：不事先为分组的传输确定传输路径，每个分组独立确定传输路径，不同分组传输途径可能不同

2. 同一报文的不同分组到达目的结点的时候，可能发现乱序、重复与失序
3. 每个分组在传输过程中都要携带源地址、目的地址和分组编号
4. 分组在交换结点存储转发的时候，需要排队处理，会带来一定的时延。通信量较大或网络拥塞时，时延会大幅增加，交换节点可视情况丢弃部分分组
5. 网路有冗余路径，可在结点或路径故障时相应更新转发表，寻找新的路径转发分组，适用于突发式通信，不适用于长报文、会话式通信

#### 虚电路方式

**结合了数据报方式和电路交换式，发挥二者的优点**

![虚电路交换过程](img\虚电路交换过程.png)

**虚电路**：一条源主机到目的主机类似于电路的路径(**逻辑连接**)，路径上所有结点都要维持这条虚电路的连接，维持一张虚电路表，每项记录一个打开的虚电路信息

1. 建立连接：源主机发送“故交请求”分组并收到“呼叫应答”分组后完成建立连接
2. 数据传输：每个分组携带虚电路号、分组号、检验和等控制信息
3. 释放连接：源主机发送“释放请求”分组以拆除虚电路

特点：

1. **虚电路**为网络层提供连接服务。源结点和目的结点建立逻辑连接而非物理连接

> <span style="color:red">连接服务</span>：为分组的传输确定传输路径，然后沿该路径传输系列分组，系列分组的传输路径相同，并且传输后拆除连接

2. 所有分组进行一次性传送，不需要携带源地址和目的地址，只包含**虚电路号**，相对数据报方式开销更小，且同一报文不会发生乱序、失序或丢失
3. 结点只进行差错检错，不进行路由选择
4. 每个结点可以建立多条虚电路，虚电路支持特定的端到端数据传输，并对数据端点进行流量控制，两个端系统之间多个虚电路为不同的进程服务
5. **致命弱点**：当网络中某个结点或某条线路出故障或失效时，所有经过该节点的虚电路都遭到破坏

#### 数据报对比虚电路

|                    | 数据报服务                           | 虚电路服务                                     |
| :----------------- | :----------------------------------- | :--------------------------------------------- |
| 连接的建立         | 不需要                               | 必须要                                         |
| 目的地址           | 每个分组有完整的目的地址             | 仅在建立阶段使用，之后的分组使用较短的虚电路号 |
| 路由选择           | 每个分组独立进行路由选择和转发       | 同一条虚电路的分组按照同一电路转发             |
| 分组顺序           | 不保证有序到达                       | 保证有序到达                                   |
| 可靠性             | 不保证可靠通信，可靠性有用户主机保证 | 可靠性由网络保证                               |
| 对网络故障的适应性 | 适应性强                             | 所有经过故障结点的虚电路均不能工作             |
| 差错处理和流量控制 | 用户主机进行流量控制，不保证可靠性   | 分组交换网负责，也可由用户主机负责             |

## 传输介质

**传输介质也称传输媒体或传输媒介**，是数据传输系统中在发送设备和接收设备之间的**物理通路**。<span style="color:red">传输媒体不是物理层</span>

> 传输媒体并不知道传输的信号代表什么意思，但是物理层由于规定了**电气特性**，所以能够识别传送到比特流

### 导向型传输介质

**电磁波被导向沿着固体媒介传播**

#### 双绞线

![](img\双绞线.png)

双绞线是最古老最常用的传输介质，由**两根**采用一定规则并排绞合的、相互绝缘的铜导线组成

**绞合可以减少对相邻导线的电磁干扰**

屏蔽双绞线：双绞线的外面加一层由金属丝编织成的屏蔽层

非屏蔽双绞线：没有屏蔽层的是双绞线

特点：

* 价格便宜
* 通信距离几公里到数十公里
* 支持模拟传输和数据传输
* 距离远时
  * 模拟传输要用放大器放大衰减信号
  * 数字传输要用中继器整形失真信号

#### 同轴电缆

![](img\同轴电缆.png)

同轴电缆由导体铜质芯线、绝缘层、网状编制屏蔽层和塑料外壳构成

可将同轴电缆分为

* $50\Omega$同轴电缆：主要传送基带数字信号，又称**基带同轴电缆**，主要用于局域网中

* $75\Omega$同轴电缆：主要传送宽带信号，又称宽带同轴电缆，主要用于有线电视系统

对比双绞线：

* 抗干扰特性强：同轴电缆具有外导体屏蔽层，广泛用于传输高速率数据
* 传输距离更远
* 价格更贵

#### 光纤

![](img\光纤.png)

光纤通信就是利用光导纤维传递光脉冲进行通信。有光脉冲为1，无光脉冲为0。

由于可见光频率$10^8$MHz，因此光纤通信的带宽远远大于其他各种传输媒体的带宽

光纤有实心纤芯和包层组成。应用全反射原理实现超低损耗，传送超远距离

**单模光纤&&多模光纤：**

![](img\单-多模光纤.png)

|          | 定义                           | 光源                 | 特点                   |
| -------- | ------------------------------ | -------------------- | ---------------------- |
| 单模光纤 | 在横向模式直线传输光信号的光纤 | 定向性号的激光二极管 | 衰耗小，适合远距离传输 |
| 多模光纤 | 有多种传输光信号模式的光纤     | 发光二极管           | 易失真，适合近距离传输 |

特点：

* 传输损耗小，中继距离长，对远距离传输特别经济
* 抗雷电和电磁干扰性好
* 无串音干扰，保密性好，不易被窃听或截取数据
* 体积小，重量轻

### 非导向型传输介质

**自由空间，介质可以是空气、真空、海水等**

#### 无线电波

**信号向所有方向进行传播**

具有较强的穿透能力，可远距离传输，广泛用于通信领域

#### 微波

**信号固定方向传播**

微波通信频率较高、频段范围宽，因此数据率很高

* 地面微博接力通信
  * 设有中继站，将信号进行方向转发，实现接力通信
* 卫星通信
  * 优点
    * 通信容量大
    * 距离远、覆盖广
    * 广播通信和多址通信
  * 缺点
    * 传播时延长250-270ms
    * 受气候影响大，误码率高
    * 成本高

#### 红外线&激光

把传输的信号分别转换为各自的信号格式，红外光信号和激光信号，在空气中传播

## 设备

### 中继器

**由于存在损耗，在线路传输的信号功率会逐渐衰减，最终导致失真，造成接收错误**

**功能**：对信号进行再生和还原，对衰减的信号进行放大，保持与原数据相同，以增加信号传输距离，延长网络长度

**中继器两端**：两端的网络部分都是网段，而不是子网，适用于完全相同的两类网络互连，并且网段速率需要相同

> 中继器只作用于信号的电气部分,只负责发送传输
>
> 两端可以连接不同的媒体
>
> 两端网段的协议一定相同，中继器不会存储转发

**5-4-3**规则：中继器只能在规定的范围内进行，否则会造成网络故障

### 集线器

集线器也叫多口中继器，对信号进行再生和整形，达到信号放大的效果

**功能**：对信号进行再生放大转发，对衰减信号进行放大，转发到其他所有非该信号输入的，处于工作状态的端口上，增加信号传输的距离，延长网络的长度。不具备信号的定向传送能力(广播)。

* 集线器不能分割冲突域：连接主机过多，且同时通信，会造成数据的碰撞
* 在集线器上的工作主机平分带宽：工作主机过多会导致每个主机分到的通信带宽过低

